<div class="group-header">
    <div class="group-title">
        {{audience.name}}
    </div>
    <div class="group-spacer"></div>
    <i class="material-icons" ng-if="!group.active">
        keyboard_arrow_{{audience.open && 'up' || 'down'}}
    </i>
</div>
<form
    ng-if="audience.open"
    ng-click="$event.stopPropagation();"
    ng-submit="save(audience)"
    class="group-content" mdl-upgrade>
    <div class="group-content-input">
        <div class="group-content-label">
            Name
        </div>
        <div class="group-content-value">
            <div class="audience-name mdl-textfield mdl-js-textfield">
                <input required ng-model="audience.name" class="mdl-textfield__input" type="text" id="{{audience.id}}-name">
                <label class="mdl-textfield__label" for="{{audience.id}}-name">Audience name</label>
            </div>
        </div>
    </div>
    <div class="group-content-input">
        <div class="group-content-label">
            Custom audiences
        </div>
        <div class="group-content-value">
            <ul class="mdl-list audience-list">
                <li
                    class="mdl-list__item"
                    ng-repeat="ca in audience.data.custom_audiences track by ca.id">
                    <span class="mdl-list__item-primary-content">
                        {{customAudienceByid(ca.id)}}
                    </span>
                    <span class="mdl-list__item-secondary-content">
                        <a
                            class="rule-delete mdl-list__item-secondary-action"
                            ng-click="deleteCustomAudience(audience, ca.id)"
                            href="javascript:void(0)">
                            <i class="material-icons">delete_forever</i>
                        </a>
                    </span>
                </li>
            </ul>
            <div class="dropdown audience-dropdown">
                <select
                    validators="[{
                        'message': 'Please fill out this field.',
                        'cond': customAudienceValidator
                    }]"
                    validators-item="audience.data.custom_audiences"
                    ng-model="audience.$caValue"
                    ng-change="addCustomAudience(audience)"
                    ng-options="item.id as item.name
                        for item in filteredCustomAudiences(audience)">
                </select>
                <label></label>
            </div>
        </div>
    </div>
    <div class="group-footer">
        <div class="group-footer-spacer"></div>
        <button
            ng-if="!group.active"
            type="button"
            class="mdl-button mdl-js-button mdl-js-ripple-effect"
            ng-click="$event.stopPropagation(); close()">
            Cancel
        </button>
        <button
            ng-if="group.active"
            type="button"
            class="mdl-button mdl-js-button mdl-js-ripple-effect"
            ng-click="$event.stopPropagation(); reset(group)">
            Reset
        </button>
        <button
            ng-disabled="!user.is_admin"
            type="submit"
            class="mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect">
            Save
        </button>
    </div>
</form>